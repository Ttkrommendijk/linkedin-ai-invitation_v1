<!doctype html>
<html>
    <head>
        <meta charset="UTF-8" />
        <style>
            body {
                font-family: Arial, sans-serif;
                width: 380px;
                margin: 12px;
            }
            input,
            textarea,
            button {
                width: 100%;
                box-sizing: border-box;
            }
            textarea {
                height: 90px;
            }
            button {
                margin-top: 8px;
                padding: 10px;
            }
            .row {
                margin-top: 10px;
            }
            small {
                color: #555;
            }
            pre {
                white-space: pre-wrap;
                word-wrap: break-word;
                background: #f6f6f6;
                padding: 8px;
                border-radius: 6px;
            }
            #profileContextPreview {
                max-height: 140px;
                overflow: auto;
            }
            #messagePrompt {
                height: 160px;
            }
            #firstMessagePreview {
                max-height: 180px;
                overflow: auto;
            }

            .tabs {
                display: flex;
                gap: 8px;
                margin-bottom: 10px;
            }
            .tab-btn {
                flex: 1;
                padding: 10px;
                border: 1px solid #ddd;
                background: #fafafa;
                border-radius: 8px;
                cursor: pointer;
            }
            .tab-btn.active {
                background: #fff;
                border-color: #bbb;
                font-weight: 600;
            }
            .tab-panel {
                display: none;
            }
            .tab-panel.active {
                display: block;
            }

            #strategy {
                height: 180px;
            }

            .inline {
                display: flex;
                gap: 8px;
            }
            .inline > * {
                flex: 1;
            }
        </style>
    </head>
    <body>
        <div class="tabs">
            <button id="tabMainBtn" class="tab-btn active" type="button">
                Invitation
            </button>
            <button id="tabMessageBtn" class="tab-btn" type="button">
                Message
            </button>
            <button id="tabConfigBtn" class="tab-btn" type="button">
                Config
            </button>
        </div>

        <div id="tabMain" class="tab-panel active">
            <div class="row">
                <small>Profile context sent to AI</small>
                <pre id="profileContextPreview">{}</pre>
            </div>

            <div class="row">
                <label
                    ><small
                        >Specific focus for this profile (optional)</small
                    ></label
                >
                <input
                    id="focus"
                    placeholder="e.g. S&OP + Slimstock + SAP S/4HANA go-live"
                />
            </div>

            <button id="generate" type="button">Generate invite</button>

            <div class="row inline">
                <button id="markInvited" type="button">Invitation sent</button>
                <button id="markAccepted" type="button">
                    Invitation accepted
                </button>
            </div>

            <div class="row">
                <small>Status</small>
                <div id="status">Idle</div>
            </div>

            <div class="row">
                <small>Preview</small>
                <pre id="preview"></pre>
            </div>
            <button id="copyBtn" type="button">Copy</button>
        </div>

        <div id="tabMessage" class="tab-panel">
            <div class="row">
                <label><small>Message prompt</small></label>
                <textarea id="messagePrompt">
Escreva a melhor primeira mensagem apos aceitar conexao no LinkedIn, em portugues.
Objetivo estrategico: abrir uma conversa com friccao minima e incentivar resposta curta.

Regras obrigatorias:
1. Agradeca por aceitar a conexao.
2. Cite uma referencia factual especifica do perfil (empresa, cargo, area de atuacao, etc).
3. Mantenha tom peer-level, neutro, especifico e nao comercial.
4. Nao faca pitch de servicos.
5. Nao elogie excessivamente.
6. Nao use adjetivos emocionais.
7. Nunca invente fatos; use apenas profile_context e profile_excerpt_fallback.

Estrutura:
- Maximo 2 paragrafos curtos.
- O segundo paragrafo deve conter:
  - Uma observacao afirmativa leve sobre o contexto profissional da pessoa.
  - Uma pergunta simples de validacao, que possa ser respondida com sim/nao ou frase curta.
  - Evite perguntas amplas, reflexivas ou que exijam explicacoes longas.

Evitar completamente:
- "quais foram os aprendizados"
- "como voce enxerga"
- "poderia compartilhar"
- perguntas profundas ou conceituais
- convite direto para reuniao
- emojis, hashtags ou bullets

A pergunta final deve reduzir friccao e facilitar resposta rapida. Sem emojis, hashtags ou bullets. Nunca invente fatos; use somente profile_context e profile_excerpt_fallback.</textarea>
            </div>

            <button id="generateFirstMessage" type="button">
                Generate first message
            </button>
            <button id="markMessageSent" type="button">Message sent</button>

            <div class="row">
                <small>Status</small>
                <div id="messageStatus">Idle</div>
            </div>

            <div class="row">
                <small>First message preview</small>
                <pre id="firstMessagePreview"></pre>
            </div>
        </div>

        <div id="tabConfig" class="tab-panel">
            <div class="row">
                <label><small>OpenAI API key (saved)</small></label>
                <input id="apiKey" type="password" placeholder="sk-..." />
            </div>

            <div class="row">
                <label><small>Model (saved)</small></label>
                <input id="model" placeholder="gpt-4.1" />
            </div>

            <div class="row">
                <label><small>Strategy (saved)</small></label>
                <textarea
                    id="strategy"
                    placeholder="Paste your strategy core here (saved)."
                ></textarea>
            </div>

            <div class="row">
                <label><small>Webhook base URL (saved)</small></label>
                <input
                    id="webhookBaseUrl"
                    placeholder="https://yourdomain.com"
                />
            </div>

            <div class="row">
                <label><small>Webhook secret (saved)</small></label>
                <input
                    id="webhookSecret"
                    type="password"
                    placeholder="shared secret"
                />
            </div>

            <button id="saveConfig" type="button">Save config</button>

            <div class="row">
                <small>Tip</small>
                <div>
                    <small
                        >Edits are saved when you click "Save config" or
                        "Generate".</small
                    >
                </div>
            </div>
        </div>

        <script src="popup.js"></script>
    </body>
</html>
