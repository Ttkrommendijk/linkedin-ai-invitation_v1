<!doctype html>
<html>
    <head>
        <meta charset="UTF-8" />
        <link rel="stylesheet" href="popup.css" />
    </head>
    <body>
        <div id="sidePanelRoot">
            <div id="topTabs">
                <button
                    id="openSidePanel"
                    type="button"
                    class="btn-small-secondary"
                >
                    Open in side panel
                </button>
                <div class="tabs">
                    <button
                        id="tabMainBtn"
                        class="tab-btn active"
                        type="button"
                    >
                        Detail
                    </button>
                    <button id="tabOverviewBtn" class="tab-btn" type="button">
                        List
                    </button>
                    <button id="tabConfigBtn" class="tab-btn" type="button">
                        Configuration
                    </button>
                </div>
            </div>

            <div id="innerContentContainer" class="app-content-scroll">
                <div id="tabMain" class="tab-panel active">
                    <div class="detail-person">
                        <div class="detail-person-top">
                            <div
                                id="detailPersonName"
                                class="detail-person-name"
                            >
                                -
                            </div>
                            <button
                                id="enrichProfileBtn"
                                type="button"
                                class="btn-enrich"
                                title="Enrich data with AI"
                            >
                                🪄
                            </button>
                        </div>
                        <div id="detailCompany" class="detail-person-company">
                            -
                        </div>
                        <div id="detailHeadline" class="detail-person-headline">
                            -
                        </div>
                    </div>

                    <div id="statusStepper" class="status-stepper">
                        <div id="step-register" class="status-step">
                            <div class="status-circle"></div>
                            <div class="status-label">Register</div>
                        </div>
                        <div id="step-invited" class="status-step">
                            <div class="status-circle"></div>
                            <div class="status-label">Invited</div>
                        </div>
                        <div id="step-accepted" class="status-step">
                            <div class="status-circle"></div>
                            <div class="status-label">Accepted</div>
                        </div>
                        <div id="step-first-message-sent" class="status-step">
                            <div class="status-circle"></div>
                            <div class="status-label">1st sent</div>
                        </div>
                        <div id="step-message-responded" class="status-step">
                            <div class="status-circle"></div>
                            <div class="status-label">Responded</div>
                        </div>
                    </div>
                    <div class="status-actions">
                        <button
                            id="statusBackBtn"
                            type="button"
                            class="btn-back"
                        ></button>
                        <button
                            id="statusForwardBtn"
                            type="button"
                            class="btn-forward"
                        ></button>
                    </div>

                    <div class="row inline detail-tabs">
                        <button
                            id="detailTabInviteBtn"
                            class="detail-tab-btn active"
                            type="button"
                        >
                            Invitation
                        </button>
                        <button
                            id="detailTabFirstMessageBtn"
                            class="detail-tab-btn"
                            type="button"
                        >
                            First Message
                        </button>
                        <button
                            id="detailTabFollowBtn"
                            class="detail-tab-btn"
                            type="button"
                        >
                            Follow
                        </button>
                    </div>

                    <div id="detailInviteSection">
                        <div class="row">
                            <label><small>Language</small></label>
                            <select id="inviteLanguage">
                                <option value="Portuguese" selected>
                                    Portuguese
                                </option>
                                <option value="English">English</option>
                                <option value="Dutch">Dutch</option>
                                <option value="Spanish">Spanish</option>
                            </select>
                        </div>

                        <div class="row">
                            <div class="label-row">
                                <label
                                    ><small
                                        >Additional prompt (optional)</small
                                    ></label
                                >
                                <span class="info-tooltip info-tooltip-right"
                                    >i
                                    <span class="info-tooltip-content"
                                        >Use this to guide the invite context
                                        for this person. This text will be
                                        appended to the standard prompt. Tip:
                                        Invites have the highest success when
                                        there are no extra notes. Only add a
                                        note when you genuinely know the person
                                        from somewhere, then reference that
                                        specific occurrence.</span
                                    ></span
                                >
                            </div>
                            <textarea
                                id="focus"
                                rows="3"
                                placeholder="Add your own prompt"
                            ></textarea>
                        </div>

                        <div class="inline invite-actions">
                            <button id="generate" type="button">
                                Generate invite
                            </button>
                            <button
                                id="saveInviteBtn"
                                type="button"
                                class="invite-save-icon"
                                hidden
                                title="Save"
                                aria-label="Save"
                            >
                                <svg
                                    xmlns="http://www.w3.org/2000/svg"
                                    width="14"
                                    height="14"
                                    viewBox="0 0 16 16"
                                    fill="currentColor"
                                    aria-hidden="true"
                                >
                                    <path
                                        d="M11 1H2a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V5L11 1Zm0 1.5L13.5 5H11V2.5ZM2 2h8v4h4v8H2V2Zm3 6a1 1 0 0 0-1 1v4h8V9a1 1 0 0 0-1-1H5Zm0 1h6v3H5V9Z"
                                    />
                                </svg>
                            </button>
                        </div>

                        <div class="row">
                            <div class="invite-preview-block">
                                <div class="invite-preview-header">
                                    <div class="invite-preview-title">
                                        Preview
                                    </div>
                                    <button
                                        id="copyInviteIcon"
                                        type="button"
                                        class="copy-icon"
                                        hidden
                                        title="Copy"
                                    >
                                        ⧉
                                    </button>
                                </div>
                                <pre
                                    id="preview"
                                    class="invite-preview-content"
                                ></pre>
                            </div>
                        </div>
                    </div>

                    <div id="detailMessageMount"></div>
                </div>

                <div id="tabMessage" class="tab-panel">
                    <div class="row">
                        <label><small>Language</small></label>
                        <select id="messageLanguage">
                            <option value="Portuguese" selected>
                                Portuguese
                            </option>
                            <option value="English">English</option>
                            <option value="Dutch">Dutch</option>
                            <option value="Spanish">Spanish</option>
                        </select>
                    </div>
                    <div id="acceptedMode">
                        <div id="initialMessageSection">
                            <div class="row">
                                <div class="label-row">
                                    <label
                                        ><small
                                            >Additional prompt (optional)</small
                                        ></label
                                    >
                                    <span
                                        class="info-tooltip info-tooltip-right"
                                        >i
                                        <span class="info-tooltip-content"
                                            >Use this to guide the first message
                                            for this person. This text will be
                                            appended to the standard
                                            prompt.</span
                                        ></span
                                    >
                                </div>
                                <textarea
                                    id="firstMessageAdditionalPrompt"
                                    rows="3"
                                    placeholder="Add your own prompt"
                                ></textarea>
                            </div>

                            <div class="inline invite-actions">
                                <button id="generateFirstMessage" type="button">
                                    Generate first message
                                </button>
                                <button
                                    id="saveFirstMessageIcon"
                                    type="button"
                                    class="invite-save-icon"
                                    hidden
                                    title="Save"
                                    aria-label="Save"
                                >
                                    <svg
                                        xmlns="http://www.w3.org/2000/svg"
                                        width="14"
                                        height="14"
                                        viewBox="0 0 16 16"
                                        fill="currentColor"
                                        aria-hidden="true"
                                    >
                                        <path
                                            d="M11 1H2a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V5L11 1Zm0 1.5L13.5 5H11V2.5ZM2 2h8v4h4v8H2V2Zm3 6a1 1 0 0 0-1 1v4h8V9a1 1 0 0 0-1-1H5Zm0 1h6v3H5V9Z"
                                        />
                                    </svg>
                                </button>
                            </div>
                        </div>

                        <div id="firstMessagePreviewSection">
                            <div class="row">
                                <div class="invite-preview-block">
                                    <div class="invite-preview-header">
                                        <div class="invite-preview-title">
                                            Preview
                                        </div>
                                        <button
                                            id="copyFirstMessage"
                                            type="button"
                                            class="copy-icon"
                                            hidden
                                            title="Copy"
                                        >
                                            ⧉
                                        </button>
                                    </div>
                                    <pre
                                        id="firstMessagePreview"
                                        class="invite-preview-content first-message-preview-content"
                                    ></pre>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="firstMessageSentMode" hidden>
                        <div class="row">
                            <label><small>Chat history</small></label>
                            <textarea
                                id="chatHistory"
                                readonly
                                placeholder="Chat history will appear here…"
                            ></textarea>
                            <button id="refreshChatHistory" type="button">
                                Refresh history
                            </button>
                        </div>
                        <div id="followupSection">
                            <div class="row">
                                <label><small>Objective</small></label>
                                <textarea
                                    id="followupObjective"
                                    placeholder="Objective for the next message…"
                                ></textarea>
                            </div>
                            <div class="row">
                                <label class="checkbox-row">
                                    <input
                                        type="checkbox"
                                        id="includeStrategy"
                                        class="strategy-checkbox"
                                        checked
                                    />
                                    <small>Include strategy</small>
                                </label>
                            </div>
                            <button id="generateFollowup" type="button">
                                Generate follow-up
                            </button>
                            <div class="row">
                                <small>Communication status</small>
                                <div id="commStatusBar">Idle</div>
                            </div>
                            <div class="row">
                                <small>Generated message preview</small>
                                <textarea id="followupPreview"></textarea>
                            </div>
                            <button id="copyFollowup" type="button">
                                Copy
                            </button>
                        </div>
                    </div>
                </div>

                <div id="tabOverview" class="tab-panel">
                    <div class="overview-filters row">
                        <input
                            id="overviewCampaignFilter"
                            placeholder="Campaign"
                        />
                        <select id="overviewArchivedFilter">
                            <option value="">Archived: All</option>
                            <option value="0">Archived: 0</option>
                            <option value="1">Archived: 1</option>
                        </select>
                        <select id="overviewStatusFilter">
                            <option value="">Status: All</option>
                            <option value="generated">generated</option>
                            <option value="invited">invited</option>
                            <option value="accepted">accepted</option>
                            <option value="first message sent">
                                first message sent
                            </option>
                        </select>
                        <input
                            id="overviewSearch"
                            placeholder="Search name/company"
                        />
                    </div>

                    <div class="overview-grid-wrap row">
                        <div
                            id="overviewLoading"
                            class="overview-loading"
                            hidden
                        >
                            Loading…
                        </div>
                        <table class="overview-grid overview-table">
                            <colgroup>
                                <col class="overview-col-open" />
                                <col class="overview-col-archive" />
                                <col class="overview-col-name" />
                                <col class="overview-col-company" />
                                <col class="overview-col-status" />
                                <col class="overview-col-date" />
                                <col class="overview-col-campaign" />
                                <col class="overview-col-archived" />
                            </colgroup>
                            <thead>
                                <tr>
                                    <th>Open</th>
                                    <th>Archive</th>
                                    <th>
                                        <button
                                            type="button"
                                            class="sort-btn"
                                            data-overview-sort="full_name"
                                        >
                                            Name
                                            <span
                                                class="sort-indicator"
                                                data-overview-sort-indicator="full_name"
                                            ></span>
                                        </button>
                                    </th>
                                    <th>
                                        <button
                                            type="button"
                                            class="sort-btn"
                                            data-overview-sort="company"
                                        >
                                            Company
                                            <span
                                                class="sort-indicator"
                                                data-overview-sort-indicator="company"
                                            ></span>
                                        </button>
                                    </th>
                                    <th>
                                        <button
                                            type="button"
                                            class="sort-btn"
                                            data-overview-sort="status"
                                        >
                                            Status
                                            <span
                                                class="sort-indicator"
                                                data-overview-sort-indicator="status"
                                            ></span>
                                        </button>
                                    </th>
                                    <th>
                                        <button
                                            type="button"
                                            class="sort-btn"
                                            data-overview-sort="most_relevant_date"
                                        >
                                            Most relevant date
                                            <span
                                                class="sort-indicator"
                                                data-overview-sort-indicator="most_relevant_date"
                                            ></span>
                                        </button>
                                    </th>
                                    <th>
                                        <button
                                            type="button"
                                            class="sort-btn"
                                            data-overview-sort="campaign"
                                        >
                                            Campaign
                                            <span
                                                class="sort-indicator"
                                                data-overview-sort-indicator="campaign"
                                            ></span>
                                        </button>
                                    </th>
                                    <th>
                                        <button
                                            type="button"
                                            class="sort-btn"
                                            data-overview-sort="archived"
                                        >
                                            Archived
                                            <span
                                                class="sort-indicator"
                                                data-overview-sort-indicator="archived"
                                            ></span>
                                        </button>
                                    </th>
                                </tr>
                            </thead>
                            <tbody id="overviewTbody"></tbody>
                        </table>
                    </div>

                    <div class="overview-pagination row">
                        <select id="overviewPageSize">
                            <option value="10">10</option>
                            <option value="25" selected>25</option>
                            <option value="50">50</option>
                        </select>
                        <button id="overviewPrevBtn" type="button">Prev</button>
                        <button id="overviewNextBtn" type="button">Next</button>
                        <div id="overviewCountLabel">Total: ?</div>
                    </div>
                </div>

                <div id="tabConfig" class="tab-panel">
                    <div class="row">
                        <label><small>OpenAI API key (saved)</small></label>
                        <input
                            id="apiKey"
                            type="password"
                            placeholder="sk-..."
                        />
                    </div>

                    <div class="row">
                        <label><small>Model (saved)</small></label>
                        <input id="model" placeholder="gpt-4.1" />
                    </div>

                    <div class="row">
                        <label><small>Strategy (saved)</small></label>
                        <textarea
                            id="strategy"
                            placeholder="Paste your strategy core here (saved)."
                        ></textarea>
                    </div>

                    <div class="row">
                        <label><small>Webhook base URL (saved)</small></label>
                        <input
                            id="webhookBaseUrl"
                            placeholder="https://yourdomain.com"
                        />
                    </div>

                    <div class="row">
                        <label><small>Webhook secret (saved)</small></label>
                        <input
                            id="webhookSecret"
                            type="password"
                            placeholder="shared secret"
                        />
                    </div>

                    <button id="saveConfig" type="button">Save config</button>

                    <div class="row">
                        <small>Tip</small>
                        <div>
                            <small
                                >Edits are saved when you click "Save config" or
                                "Generate".</small
                            >
                        </div>
                    </div>
                </div>
            </div>
            <div id="commFooter" class="comm-status-footer">
                <small>Status</small>
                <div id="commFooterText">Ready</div>
            </div>
        </div>

        <script src="../shared/utils.js"></script>
        <script src="../prompts.js"></script>
        <script src="popup.js"></script>
    </body>
</html>
